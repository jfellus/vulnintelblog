# CVE-2025-64446 - Critical FortiWeb relative path traversal - Reproduction lab

WARNING: The [existing Nuclei template](https://github.com/projectdiscovery/nuclei-templates/blob/d35f3376c67383ccd2b1861cf1db3ab1f43d8dbb/http/cves/2025/CVE-2025-64446.yaml#L2) for CVE-2025-64446 is very intrusive (it creates an admin user). This lab provides a non-intrusive probe to check for the vulnerability without exploiting it.

1. **Vulnerable FortiWeb setup**

Register to [Fortinet Support](https://support.fortinet.com/) and download a FortiWeb VM image (versions 7.x or 8.x) from http://support.fortinet.com/support/#/downloads/vm

For instance, a KVM image for FortiWeb 7.4.9 can be downloaded from https://support.fortinet.com/app/download/api/file/4b66f414-cb6e-4e6e-b939-e44ee572bbc1.
Unzip it to `vulnerable/` then start the VM:

```bash
./run-vulnerable.sh
```

2. **Exploit the vulnerability**

Submit a crafted HTTP request involving relative path traversal, such as `/api/v2.0/cmdb/system/admin%3f/../../../../../cgi-bin/fwbcgi`:
```bash
uv run python3 poc.py
```

A new admin user should have appeared under

3. **OR Probe the vulnerability without exploitation**

Submit a non-invasive GET HTTP request to check for vulnerability without altering the appliance:
```bash
uv run python3 probe.py
```

4. **Check patched FortiWeb setup isn't vulnerable**

To verify the vulnerability has been patched, download a patched FortiWeb VM image (version 7.4.10 or 8.0.5 onwards), unzip it to `patched/` and start the VM:

```bash
./run-patched.sh
uv run python3 probe.py
```

5. **Probe with Nuclei template**

```bash
nuclei -vv -u https://127.0.0.1:8443 -t nuclei_cve-2025-64446.yaml -nc
```
